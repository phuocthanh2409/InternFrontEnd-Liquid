{%- liquid
    assign setting  =  section.settings 
    assign collection = collections[section.settings.collection]
    assign rows =  section.settings.rows
    assign size = collection.products | size 
-%}
<div class="container">
    <div class="home-product-slide" id="home-product-section-{{section.id}}" data-section-type="slideshow">
        {%- unless collection.products == 0 -%}
            <div class="home-product-slide-title-button">
                <div class="home-product-slide-title">
                    <p>{{section.settings.title}}</p>
                </div>
                <div class="home-product-slide-button" id="home-product-slide-button">
                    <button class="home-product-slide-pre">
                        <svg width="18" height="14" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.91127 0.338713L7.8364 0.256282C7.51196 -0.0591419 7.00145 -0.0834052 6.64839 0.183492L6.5636 0.256282L0.263604 6.38128L0.226346 6.41975L0.176701 6.47911L0.112204 6.57645L0.0641029 6.67508L0.0322606 6.76726L0.00621645 6.89667L0 7L0.00250908 7.06583L0.0182161 7.17563L0.0447643 7.27312L0.084306 7.37032L0.131396 7.45562L0.19772 7.54727L0.263604 7.61872L6.5636 13.7437C6.91508 14.0854 7.48492 14.0854 7.8364 13.7437C8.16083 13.4283 8.18579 12.932 7.91127 12.5887L7.8364 12.5063L3.0744 7.875H17.1C17.5971 7.875 18 7.48325 18 7C18 6.51675 17.5971 6.125 17.1 6.125H3.0726L7.8364 1.49372C8.16083 1.1783 8.18579 0.681968 7.91127 0.338713L7.8364 0.256282L7.91127 0.338713Z" fill="#BABCBF"/>
                        </svg>
                    </button>
                    <button class="home-product-slide-next">
                        <svg width="18" height="14" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M10.0887 0.338713L10.1636 0.256282C10.488 -0.0591419 10.9985 -0.0834052 11.3516 0.183492L11.4364 0.256282L17.7364 6.38128L17.7737 6.41975L17.8233 6.47911L17.8878 6.57645L17.9359 6.67508L17.9677 6.76726L17.9938 6.89667L18 7L17.9975 7.06583L17.9818 7.17563L17.9552 7.27312L17.9157 7.37032L17.8686 7.45562L17.8023 7.54727L17.7364 7.61872L11.4364 13.7437C11.0849 14.0854 10.5151 14.0854 10.1636 13.7437C9.83917 13.4283 9.81421 12.932 10.0887 12.5887L10.1636 12.5063L14.9256 7.875H0.9C0.402944 7.875 0 7.48325 0 7C0 6.51675 0.402944 6.125 0.9 6.125H14.9274L10.1636 1.49372C9.83917 1.1783 9.81421 0.681968 10.0887 0.338713L10.1636 0.256282L10.0887 0.338713Z" fill="#14171A"/>
                        </svg>
                    </button>
                </div>
            </div>
        {%- endunless -%}
        
        {%- case rows -%}
            {%- when '1' -%}
                <div id="home-product-slide-{{section.id}}">
                    {%- for product in collection.products -%}
                        <div>
                            {%- render 'product-list' product:product -%}
                        </div>
                    {%- endfor -%}
                </div>
            {%- when '2' -%}
                <div id="home-product-slide-{{section.id}}">
                    {%- liquid 
                      assign loopCount = size | divided_by: 2.00 | ceil 
                    -%}
                    {%- for i in (1..loopCount)-%}
                        {%- if forloop.first -%}
                            {%- assign offset = 0 -%}
                        {%- else -%}
                            {%- assign offset = offset | plus: 2 -%}
                        {%- endif -%}
                        <div>
                            {%- for product in collection.products offset: offset limit: 2 -%}
                                    <div class="home-product-slide-content">
                                        <div class="home-product-slide-content-promotion-like">
                                            {%- if product.compare_at_price > product.price -%}
                                                <div class="home-product-slide-content-promotion">
                                                    <p>-{{ product.compare_at_price | minus: product.price | times: 100.0 | divided_by: product.compare_at_price | round }}%</p>
                                                </div>
                                            {%- endif -%}
                                            <div class="home-product-slide-content-like">
                                                <a href="#">
                                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M11.2153 5.9161L11.9997 6.90814L12.7841 5.91615C15.1841 2.8812 19.1198 3.74956 20.504 6.46519C21.1766 7.78471 21.2851 9.64824 20.0667 11.867C18.8773 14.0328 16.4167 16.5334 11.9997 19.052C7.58301 16.5334 5.1225 14.0328 3.93324 11.867C2.71494 9.64827 2.82343 7.78473 3.49602 6.46519C4.88026 3.74949 8.81578 2.88128 11.2153 5.9161Z" stroke="#343F49" stroke-width="2"/>
                                                    </svg>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="home-product-slide-content-image">
                                            <a href="{{product.url}}">
                                                {%- if product.featured_image != blank -%}
                                                    <img src="{{ product.featured_image | img_url: 'master' }}" alt="{{ product.featured_image.alt}}">
                                                {%- else -%}
                                                    {{ 'image' | placeholder_svg_tag }}
                                                {%- endif -%} 
                                            </a>
                                        </div>
                                        <div class="home-product-slide-content-type">
                                            {% comment %} <a href="#">
                                                <h3>{{block.settings.type}}</h3>
                                            </a> {% endcomment %}
                                            <p>{{product.vendor | link_to_vendor}}</p>
                                        </div>
                                        <div class="home-product-slide-content-title">
                                            <a href="{{product.url}}">
                                                <h1>{{product.title}}</h1>
                                            </a>
                                        </div>
                                        <div class="home-product-slide-content-price-button">
                                            <div class="home-product-slide-content-price">
                                                {%- if product.compare_at_price > product.price -%}
                                                    <div class="home-product-slide-content-price-sale">
                                                        {{product.price | money}}
                                                    </div>
                                                    <div class="home-product-slide-content-price-sale-original">
                                                        {{product.compare_at_price | money}}
                                                    </div>
                                                {%- else -%}
                                                    <div class="home-product-slide-content-price-original">
                                                        {{product.compare_at_price | money}}
                                                    </div>
                                                {%- endif -%}

                                            </div>
                                            <div class="home-product-slide-content-button">
                                                <a href="#">
                                                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <rect width="48" height="48" rx="2" fill="#272E35"/>
                                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M20.5 31C21.3284 31 22 31.6716 22 32.5C22 33.3284 21.3284 34 20.5 34C19.6716 34 19 33.3284 19 32.5C19 31.6716 19.6716 31 20.5 31ZM29.5 31C30.3284 31 31 31.6716 31 32.5C31 33.3284 30.3284 34 29.5 34C28.6716 34 28 33.3284 28 32.5C28 31.6716 28.6716 31 29.5 31ZM15 14H17C17.4556 14 17.8483 14.3068 17.9651 14.7377L17.9884 14.8479L18.4733 18H33C33.5998 18 34.0549 18.5207 33.9951 19.1003L33.9762 19.2169L32.3242 26.6508C32.0325 27.9637 30.9059 28.9143 29.5779 28.9945L29.3957 29H20.7158C19.2944 29 18.077 28.0044 17.7827 26.6299L17.7507 26.4562L16.1421 16H15C14.4477 16 14 15.5523 14 15C14 14.4872 14.386 14.0645 14.8834 14.0067L15 14H17H15ZM31.7534 20H18.781L19.7275 26.1521C19.7967 26.6024 20.1597 26.9438 20.6034 26.9937L20.7158 27H29.3957C29.8253 27 30.2021 26.7265 30.3402 26.3285L30.3718 26.2169L31.7534 20Z" fill="white"/>
                                                    </svg>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                            {%- endfor -%}
                        </div>
                    {%- endfor -%}
                </div>
        {%- endcase -%}
        <script type="application/json" data-tns-config>
            {
                "container": "#home-product-slide-{{section.id}}",
                "items": 4,
                "swipeAngle": false,
                "speed": 400,
                "nav": false,
                "loop": false,
                "controlsContainer": "#home-product-slide-button",
                "edgePadding": 10,
                "gutter": 30,
                "mouseDrag": true,
                "responsive": {
                "640": {
                    "items": 2
                },
                "700": {
                    "items": 3
                },
                "1250": {
                    "items": 4
                }
                }
            }
        </script>
    </div>
</div>
{% schema %}
{
    "name": "Home Product Slide",
    "class": "home product slide",
    "settings": [
        {
            "type": "text",
            "id": "title",
            "label": "Title"
        },
        {
            "type":"collection",
            "id":"collection",
            "label":{
                "en":"Collection"
            }
        },
        {
          "type": "select",
          "id": "rows",
          "label" : {
            "en" : "Rows"
          },
          "options": [
           {
              "value": "1",
              "label": {
                "en": "1"
              }
           },
           {
             "value": "2",
             "label": {
               "en": "2"
             }
           }
          ]
        }
    ],
    "blocks": [],
    "presets": [
        {
            "name": "Slide Product",
            "category": "Advanced layout"
        }
    ]
}
{% endschema %}